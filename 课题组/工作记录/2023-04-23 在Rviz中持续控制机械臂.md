### 一、设想
通过上一节发送静态数据控制机械臂后，想着如何让机械臂能够持续运动。
### 二、实验
将自己发布节点的源代码做了一些修改后，然后发送动态的数据
![[Pasted image 20230423154537.png]]
### 三、问题
你会发现确实是动态数据，/joint_states 这个话题也确实接收到了动态的数据，但是机械臂只动了一次（就是最开始发布的那条数据），就很奇怪？？？

![[Pasted image 20230423154733.png]]

### 四、解决方法（不需要simulink直接两个节点通信就能实现）
①一开始我的源码中的消息数据更新只是在while循环里更新一个position[0]，然后就发送，然后就会出现上面的问题，就是机械臂无法持续运动。
```c++
sensor_msgs::JointState msg;
while(ros::ok()){
	Count = Count + 0.01;
	//更新
	msg.position[0] += count;
	//然后就发布
}
```

②然后查阅资料，换了一种更新消息的方式
就是在while里给消息进行赋值，而不是在外面赋值后，再在while中修改，这样进行发布就会发现成了！
![[Pasted image 20230423164652.png]]

#### 分析
怀疑可能是虽然在topic中是发布了消息，有数据的改变，但是第一种方式发布的消息、、、算了，暂时想不出来为什么。。。。

### 五、后续工作
#### 1.思路
改变发布的话题，命名为/myjoint_states，在matlab中订阅此话题（模拟接收来自Touch X的信息，可以增加用户交互代码，自己输入关节角然后发布），然后改变其中的消息数据再发布到/joint_states中给Rviz中的机械臂，实现所谓的最基本的遥操作。

#### 已实现
①已测试成功，主端→matlab→从端      实现联动
![[Pasted image 20230423191227.png]]

②成功测试，关节空间映射（自己编写的pub模拟作为主端发送的关节角数据，matlab进行订阅并进行修改，发布给Gluon，数据正确）仿真成功！
![[Pasted image 20230423203931.png]]

