### 一、建立步骤
1、在.bashrc中加入本机的ip地址（ROS中的ifconfig）
```sh
export ROS_IP=192.168.40.147
```
2、运行roscore，找到
```sh
ROS_MASTER_URI=http://ubuntu:11311/
```
3、在matlab中输入以下指令
```matlab
setenv('ROS_MASTER_URI','http://ubuntu:11311/')
rosinit
```
4、显示下面的输出则配置成功，并且可以在matlab中使用ros的指令
![[Pasted image 20230422114538.png]]

### 二、测试通信
1、matlab端（正常）
![[Pasted image 20230422114916.png]]

2、ros端（正常）
![[Pasted image 20230422115030.png]]

### 三、测试matlab中给ros-Rviz中的机械臂发送指令
#### 问题：能够给指定话题发送消息（确实在发送），但是postiion数据有误（没有数据）
![[Pasted image 20230422170437.png]]
给了一定的数据，但是关节状态话题接收不到给的数据
![[Pasted image 20230422170537.png]]
#### 分析：怀疑是没有指定名称（关节的名称asix_joint_1 。。。）

#### 测试一下，是否不写对名称是不是不能接收到位置信息
①名称正确，给关节一个角度，这是还没发送之前的状态。
![[Pasted image 20230422171846.png]]
发送完之后，显然它动了
![[Pasted image 20230422171955.png]]

②现在使关节一的名称不正确，给一个另外的角度1.57

![[Pasted image 20230422172140.png]]

发现它不动，还是保持原来的位置，但是话题里有1.57这个数据
![[Pasted image 20230422172243.png]]

③我们再改回正确的名称，依然用1.57看看，它会不会动
发现它回原位了
![[Pasted image 20230422172535.png]]

#### 结论
①根据测试可以知道：需要指定关节的名称，然后发送数据，才能使关节转动，并且这个关节名称来自URDF文件中的关节命名，所以猜想改变URDF中的关节名就可以改变JointStates这个消息格式中的name变量的值。
②但是，最开始的那个问题还没解决，就是即使我再matlab中没有指定名称，根据测试的规律来说我也应该再echo topic的时候能在position看到有数据，但是没有。


#### 解决办法
①一开始我是想自己按照消息格式自己编辑一个消息发给/jointstates这个话题的，但是在matlab中碰到一些有关数据维度的问题、还有不知道如何在matlab中处理字符串数据，一时半会我也解决不了。所以这个方法我放弃了。
②于是我想既然在matlab中我不好处理数据格式的问题，那我就从ROS中再建一个话题叫/myjoint_states，我在这个话题上发布数据，然后我只需要再matlab中订阅然后改变position这个量（比如做关节空间的映射，写个func函数就行），这都是数字，我可以解决，所以就如下图所示，这样改变后的数据再发送给Rviz中的Gluon模型，发现它动了，检查数据也是我给定的，成功实现！
![[Pasted image 20230422200113.png]]
$[0,pi/2,pi2,0,pi/2,0]$确实应该是长这个样子。

![[Pasted image 20230422200459.png]]

### 四、后续工作
现在只是静态发布指令，后面要实现动态发布并让机械臂持续运动